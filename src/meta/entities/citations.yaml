citations:
  type: table
  displayName: CSL
  order: '21'
  primaryKey: ID
  scheme:
    columns:
    - ID:
        type: KEYTYPE
        autoIncrement: true
        primaryKey: true
    - name:
        type: VARCHAR(100)
    - title:
        type: VARCHAR(255)
        canBeNull: true
    - format:
        type: VARCHAR(30)
    - parent:
        type: VARCHAR(100)
        canBeNull: true
    - inline:
        type: VARCHAR(2000)
    - bibliography:
        type: VARCHAR(2000)
    - updated:
        type: TIMESTAMP
  queries:
  - '*** Selection view ***':
      type: 1D
      invisible: true
      code: SELECT ID AS "Code", name AS "Name" FROM citations
  - All records:
      type: 1D
      roles: Annotator
      operations:
      - Delete
      - AdminDelete
      - Insert
      - InsertFromZotero
      - AddRemoveCategory
      code: |-
          SELECT
            cit.ID AS "___ID",
            cit.name AS "Name",
            cit.title AS "Title",
            '<quick visible="false" />' AS ";Title",
            cit.format AS "Format",
            cit.inline AS "Inline",
            cit.bibliography AS "Bibliography",
            '<css class="bibliography-col"/>' AS ";Bibliography",
            cit.parent AS "Parent",
            '<quick visible="false" />' AS ";Parent"
          FROM citations cit
          INNER JOIN citation2user c2u ON c2u.citationID = cit.ID
          WHERE c2u.user_name = <session:current-user />
             OR c2u.user_name = 'zotero'
  operations:
  - Insert:
      type: Groovy
      roles: Annotator
      file: citations.Insert.groovy
  - InsertFromZotero:
      type: Groovy
      roles: Administrator
      file: citations.InsertFromZotero.groovy
  - Delete:
      type: Groovy
      records: 2
      roles: Annotator
      file: citations.Delete.groovy
  - AdminDelete:
      records: 2
      roles: Administrator
      code: com.developmentontheedge.be5.operations.SilentDeleteOperation
  - AddRemoveCategory:
      records: 2
      roles: Annotator
      code: com.developmentontheedge.be5.modules.core.operations.categories.AddRemoveCategory

